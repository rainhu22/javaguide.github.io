<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL | </title><meta name="author" content="Rain Hu"><meta name="copyright" content="Rain Hu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Mysql 查询现在使用的数据库 select database; 删除 drop database db_name; 使用 use db_name;  表结构操作： 先写名称再写类型 12345create table tb_username(	id int [primary key(主键) auto increment(自动增加)] comment &#x27;描述&#x27;，    use">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="http://example.com/2023/11/30/MySQL/index.html">
<meta property="og:site_name">
<meta property="og:description" content="Mysql 查询现在使用的数据库 select database; 删除 drop database db_name; 使用 use db_name;  表结构操作： 先写名称再写类型 12345create table tb_username(	id int [primary key(主键) auto increment(自动增加)] comment &#x27;描述&#x27;，    use">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/spongebob.jpg">
<meta property="article:published_time" content="2023-11-30T02:51:58.000Z">
<meta property="article:modified_time" content="2024-05-20T02:59:21.865Z">
<meta property="article:author" content="Rain Hu">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/spongebob.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/11/30/MySQL/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-20 10:59:21'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/image/spongebob.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/image/miku.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title=""><span class="site-name"></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-30T02:51:58.000Z" title="发表于 2023-11-30 10:51:58">2023-11-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-05-20T02:59:21.865Z" title="更新于 2024-05-20 10:59:21">2024-05-20</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MySQL"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h1><ol>
<li><p>查询现在使用的数据库 <code>select database;</code></p>
<p>删除 <code>drop database db_name;</code></p>
<p>使用 <code>use db_name;</code></p>
</li>
<li><p>表结构操作： 先写名称再写类型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_username(</span><br><span class="line">	id <span class="type">int</span> [<span class="keyword">primary</span> key(主键) auto increment(自动增加)] comment <span class="string">&#x27;描述&#x27;</span>，</span><br><span class="line">    username <span class="type">varchar</span>(<span class="number">20</span>) [<span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span> <span class="keyword">default</span> <span class="string">&#x27;n&#x27;</span> ]comment <span class="string">&#x27;用户名&#x27;</span></span><br><span class="line">)comment <span class="string">&#x27;用户表&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>数据类型 数值类型 tinyint smallint mediumint int bigint float(a, b) a表示整个数字长度 b表示小数位个数  double decimal</p>
<p>字符串类型 char(10) 10表示占用空间 varchar(10)可超过10个字符 </p>
<p>日期类型</p>
</li>
<li><p><code>desc tb_name</code>查看表的结构</p>
</li>
<li><p>修改表的字段：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> xx</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name modify xx</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name change xx xx <span class="type">varchar</span>(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>对数据库内的数据进行增删改查</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_name(username, name gender, create_time, update_time) <span class="keyword">values</span>(&quot;xx&quot;, <span class="string">&#x27;xx&#x27;</span>, <span class="number">1</span>, now(), now());</span><br><span class="line"># 若是批量插入接逗号即可</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> tb_name <span class="keyword">set</span> name<span class="operator">=</span><span class="string">&#x27;xx&#x27;</span>, up_datetime<span class="operator">=</span>now() <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"># 不加<span class="keyword">where</span>会更新整列</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"># 不加<span class="keyword">where</span>会更新整列</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>查询操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [<span class="keyword">distinct</span>去重] 字段(若为<span class="operator">*</span>代表所有字段) [<span class="keyword">as</span> 别名 用于直观展示] <span class="keyword">from</span> 表名 <span class="keyword">where</span> id<span class="operator">=</span>xx, name<span class="operator">=</span>xx;</span><br><span class="line"></span><br><span class="line"># 条件查询</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> age <span class="keyword">between</span> <span class="number">10</span> <span class="keyword">and</span> <span class="number">20</span> <span class="keyword">and</span> gender<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> age <span class="keyword">in</span> (<span class="number">10</span>,<span class="number">12</span>,<span class="number">13</span>);</span><br><span class="line"></span><br><span class="line"># 模糊查询 一个下划线为一个字符， <span class="operator">%</span>匹配任意个字符</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;__&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;张%&#x27;</span>  # 查所有姓张的</span><br><span class="line"># 不等于用 <span class="keyword">not</span> <span class="keyword">in</span> （）代替</span><br><span class="line"># 空集用大写<span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>聚合函数和排序查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 统计总数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(name) <span class="keyword">from</span> tb_name  # 不统计<span class="keyword">null</span>值</span><br><span class="line">... <span class="built_in">min</span>(age);</span><br><span class="line"></span><br><span class="line"># 分组查询</span><br><span class="line"><span class="keyword">select</span> gender, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> tb_name <span class="keyword">where</span> age<span class="operator">&gt;</span><span class="number">10</span>  <span class="keyword">group</span> <span class="keyword">by</span> gender[<span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">2</span> 对分组之后的数据进行过滤];</span><br><span class="line"># 按性别统计总数</span><br><span class="line"># <span class="keyword">where</span>是分组前进行的筛选</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">order</span> <span class="keyword">by</span> age, <span class="type">date</span> <span class="keyword">asc</span>[<span class="keyword">desc</span>] ;  # 升序排列, 第一个相同时排序第二个</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>分页查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name limit <span class="number">0</span>,<span class="number">5</span>;  #查起始id为<span class="number">0</span>的数据 每页五个数据</span><br></pre></td></tr></table></figure>


</li>
<li><p>多表 一对多 一对一 多对多</p>
<p>物理外键：一个学生对应多个信息 如班级、性别，将班级表和学生表之间添加约束 学生表添加外键约束 不适用集群和分布式场景，影响效率</p>
<p>逻辑外键：通过外部代码解决依赖关系</p>
<p>多对多：学生和课程 建立学生表和课程表，再建立第三表，分别关联两方主键：学生id和课程id</p>
<p><img src="/2023/11/30/MySQL/image-20240318213934105.png" alt="image-20240318213934105"></p>
</li>
<li><p>多表查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb1, tb2;  # 笛卡尔积 包含重复的 无效数据</span><br><span class="line"><span class="keyword">select</span> tb1.name, tb2.name <span class="keyword">from</span> tb1, tb2 <span class="keyword">where</span> tb1.id_x <span class="operator">=</span> tb2.id_y  # 隐式内连接</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb1.name, tb2.name <span class="keyword">from</span> tb1 <span class="keyword">join</span> tb2 <span class="keyword">on</span> tb1.idx <span class="operator">=</span> tb2.idy  # 显式内连接</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Mysql事务</strong> 一组操作的集合，事务会将所有操作作为整体向体系提交，要么全部成功要么全部失败</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line">xxx # <span class="keyword">sql</span>语句</span><br><span class="line"><span class="keyword">commit</span>; # 提交事务</span><br><span class="line"><span class="keyword">rollback</span>; # 回滚</span><br></pre></td></tr></table></figure>
</li>
<li><p>索引创建</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index idx_name <span class="keyword">on</span> tb_name(xx);  # xx为字段名</span><br><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> tb_name;</span><br><span class="line"><span class="keyword">drop</span> index index_name <span class="keyword">on</span> tb_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行sql查询语句发生了什么</p>
<p>连接器：建立连接，管理连接、校验用户身份；</p>
<p>查询缓存：查询语句如果命中查询缓存则直接返回，否则继续往下执行。MySQL 8.0 已删除该模块；</p>
<p>解析 SQL，通过解析器对 SQL 查询语句进行词法分析、语法分析，然后构建语法树，方便后续模块读取表名、字段、语句类型；</p>
<p>执行 SQL：执行 SQL 共有三个阶段：</p>
<ul>
<li>预处理阶段：检查表或字段是否存在；将 <code>select *</code> 中的 <code>*</code> 符号扩展为表上的所有列。</li>
<li>优化阶段：基于查询成本的考虑， 选择查询成本最小的执行计划；</li>
<li>执行阶段：根据执行计划执行 SQL 查询语句，从存储引擎读取记录，返回给客户端</li>
</ul>
</li>
<li><p>第一类丢失更新，一个事务回滚，导致另一个事务更新丢失</p>
<p>第二类丢失更新，一个事务提交修改，导致另一个更新丢失</p>
</li>
<li><p>并发事务引发的问题 </p>
<p>a. 脏读 B读到了A还未提交的数据 </p>
<p>b. 不可重复读  同一个事务内 两次读的数据不同</p>
<p>c. 幻读  例如插入数据时发生已经存在，同一个表前后查询到的行数不一样</p>
<p>解决办法：事务隔离</p>
<ol>
<li>读未提交</li>
<li>读已提交解决a  只有提交时才能被其他事务看到</li>
<li>可重复读解决a b 默认隔离级别</li>
<li>串行化全解决，效率低</li>
</ol>
</li>
<li><p>缓存同步到磁盘时可能出现问题，不能发生改变时立即读写，因为缓存池中的数据频繁更新时读写磁盘性能差，redo log用于记录事务提交时的数据页修改，实现事务持久性，先写入log中，再写入到磁盘中WAL预写日志</p>
</li>
<li><p>undo log用于提供回滚，记录逻辑日志，通过逆操作恢复数据保证原子性</p>
</li>
<li><p>MVCC multi-version concurrency control多版本并发控制，使得读写操作没有冲突</p>
<p>隐藏字段 包括事务transaction-ID 以及回滚指针指向上一个版本</p>
<p>undo log，回滚日志 记录不同版本的数据，并形成链表</p>
<p>ReadView 根据匹配规则判断当前事务访问哪个版本的数据</p>
</li>
<li><p>MySQL主从同步 主库将数据变更记录写入二进制日志Binlog中，从库读取之后写入到中继日志relaylog 从库重做relay log的操作</p>
</li>
<li><p>单表数据超过1000W或者20GB考虑分库分表，分担访问压力</p>
<p>垂直分库 按业务分类 拆分到不同DB</p>
<p>垂直分表 根据字段属性如不常用的字段分一表 大字段 大文本分一类 冷热数据分离</p>
<p>水平 类似于平均分，解决海量数据和高并发问题</p>
</li>
</ol>
<h2 id="Mysql锁机制"><a href="#Mysql锁机制" class="headerlink" title="Mysql锁机制"></a>Mysql锁机制</h2><ol>
<li><p>整体结构：</p>
<img src="/2023/11/30/MySQL/image-20240419135818317.png" alt="image-20240419135818317" style="zoom:50%;">
</li>
<li><p>乐观锁通过维护版本号来</p>
</li>
<li><p>排他锁和不和其他类型的锁兼容(<strong>禁止其他线程读取正在写入的数据</strong>)，共享锁可以</p>
</li>
<li><p>InnoDB存储引擎有3种行锁的算法，其分别是：</p>
<ol>
<li>Record Lock（记录锁）：单个行记录上的范围 (锁住某一行记录)</li>
<li>Gap Lock（间隙锁）：间隙锁，锁定一个范围，但不包含记录本身 (锁住一段左开右开的区间)</li>
<li>Next-key Lock（临键锁）：Gap Lock + Record Lock，锁定一个范围，并且锁定记录本身 (锁住一段<strong>左开右闭</strong>的区间)</li>
</ol>
</li>
<li><p>悲观锁包括共享锁（S锁）和排他锁（X锁）</p>
</li>
<li><p>如果需要用到<strong>表锁</strong>的话，如何判断表中的记录没有行锁呢，一行一行遍历肯定是不行，性能太差。我们需要用到一个叫做意向锁的来快速判断是否可以对某个表使用表锁。</p>
<p>意向锁是表级锁，共有两种：</p>
<ul>
<li><strong>意向共享锁（Intention Shared Lock，IS 锁）</strong>：事务有意向对表中的某些记录加共享锁（S 锁），加共享锁前必须先取得该表的 IS 锁。</li>
<li><strong>意向排他锁（Intention Exclusive Lock，IX 锁）</strong>：事务有意向对表中的某些记录加排他锁（X 锁），加排他锁之前必须先取得该表的 IX 锁。</li>
</ul>
</li>
</ol>
<h2 id="索引失效场景"><a href="#索引失效场景" class="headerlink" title="索引失效场景"></a>索引失效场景</h2><p><strong>当Mysql发现通过索引扫描的行记录数超过全表的30%时，优化器就会放弃走索引，变成全表扫描。</strong></p>
<ol>
<li>最左匹配原则<br>联合合索引遵从最左匹配原则，顾名思义，<strong>在联合索引中，最左侧的字段优先匹配</strong>。因此，在创建联合索引时，where子句中使用最频繁的字段放在组合索引的最左侧</li>
<li>使用了Select * 语句<br>有些情况下是可以走覆盖索引，当使用了<code>select *</code> ，肯定是不会走索引的。</li>
<li>索引列参与运算、函数；例如运算<code>explain select * from t_user where id + 1 = 2 ;</code> 函数 <code>explain select * from t_user where SUBSTR(id_no,1,3) = &#39;100&#39;;</code></li>
<li>使用模糊查询Like，%代表模糊匹配出现在首部<code>explain select * from t_user where id_no like &#39;%00%;</code></li>
<li>类型隐式转换，本来是Char类型，SQL中使用了Int</li>
<li>Order By导致失效，因为重新排序了</li>
<li>查询条件中使用 OR，且 OR 的前后条件中有一个列没有索引，涉及的索引都不会被使用到;</li>
<li>使用了不等于&lt;&gt;符号 </li>
<li>范围查询断索引<br>范围查询断索引，意思是在查询条件中间如果出现了范围查询，从范围查询处开始，后续的索引字段会失效，用了范围查询后框出来的是一个范围而不是一个具体的节点，自然走到这里就走不下去了，后续的条件必须去和范围里的每个节点进行比对、匹配。</li>
</ol>
<h2 id="覆盖索引"><a href="#覆盖索引" class="headerlink" title="覆盖索引"></a>覆盖索引</h2><p>覆盖索引是指查询使用了索引，并且需要返回的列，在该索引中已经全部能够找到</p>
<h2 id="如何处理慢查询"><a href="#如何处理慢查询" class="headerlink" title="如何处理慢查询"></a>如何处理慢查询</h2><ol>
<li>开启慢查询日志</li>
<li>设置慢查询阀值</li>
<li>确定慢查询日志路径</li>
<li>确定慢查询日志的文件名</li>
<li>查看日志，使用Explain语句查看运行情况</li>
</ol>
<h2 id="Mysql查询什么时候用Gap锁"><a href="#Mysql查询什么时候用Gap锁" class="headerlink" title="Mysql查询什么时候用Gap锁"></a>Mysql查询什么时候用Gap锁</h2><p>非唯一索引的等值查询或者范围查询的时候，由于前后都可以再插入新的等值数据，为了防止幻读，要锁定前后两个范围</p>
<h2 id="InnoDB和MyISAM区别"><a href="#InnoDB和MyISAM区别" class="headerlink" title="InnoDB和MyISAM区别"></a>InnoDB和MyISAM区别</h2><ul>
<li>MySQL 5.5 之前，MyISAM 引擎是 MySQL 的默认存储引擎，MySQL5.5 版本之后，InnoDB 是 MySQL 的默认存储引擎；</li>
<li>MyISAM 只有表级锁，而 InnoDB 支持行级锁，也就是说，<strong>MyISAM 一锁就是锁住了整张表，而 InnoDB 可以只锁住某几行数据，并发时性能更好</strong>；</li>
<li>MyISAM 不提供事务支持，<strong>InnoDB 提供事务支持</strong>；</li>
<li>MyISAM 不支持外键，而 <strong>InnoDB 支持外键</strong>，外键对于维护数据一致性非常有帮助，但是对性能有一定的损耗；</li>
<li><strong>数据库异常崩溃后，InnoDB 能够安全恢复</strong>，而MyISAM不能。使用 InnoDB 的数据库在异常崩溃后，数据库重新启动的时候会保证数据库恢复到崩溃前的状态；</li>
<li>MyISAM不支持MVCC，而InnoDB支持（MVVC是行级锁的优化）；<ul>
<li>MVCC是多版本并发控制，为每次事务生成一个新版本数据，每个事务都由自己的版本，从而不加锁就决绝读写冲突；</li>
</ul>
</li>
<li>索引实现方式不同，虽然都是B+ Tree，但 <strong>InnoDB 引擎中，其数据文件本身就是索引文件</strong>，而 MyISAM 的索引文件和数据文件是分离的（非聚簇索引）；</li>
<li>MyISAM表<strong>可以没有主键</strong>，InnoDB必须有主键</li>
</ul>
<h2 id="B树和B-树对比"><a href="#B树和B-树对比" class="headerlink" title="B树和B+树对比:"></a>B树和B+树对比:</h2><ul>
<li><p>B树如何保证平衡？</p>
<ul>
<li>每个结点的值(索引) 都是按递增次序排列存放的，并遵循左小右大原则。</li>
<li>根结点的子节点个数为 **[2，M]**。也就是可以有多个</li>
<li>除根节点和叶子节点外，其他节点至少有<strong>⌈m&#x2F;2⌉（向上取整）</strong>个子节点。至多为M</li>
<li>每个非叶子结点的值(索引) 个数 &#x3D; 子节点个数 -1 。最小为 ⌈m&#x2F;2⌉-1 最大为 M-1 个。</li>
<li>B树的所有叶子结点都位于同一层。</li>
</ul>
<hr>
</li>
<li><p>B树节点存了数据，能存的指针较少，相对来说相同数据深度更深，效率低；</p>
</li>
<li><p>如果范围查询，B+树能直接遍历叶子节点的有序链表，而B树有部分数据存在上一层节点中</p>
</li>
</ul>
<h2 id="索引相关"><a href="#索引相关" class="headerlink" title="索引相关"></a>索引相关</h2><h3 id="聚簇与非聚簇"><a href="#聚簇与非聚簇" class="headerlink" title="聚簇与非聚簇"></a>聚簇与非聚簇</h3><p>聚簇索引中数据与索引都存在一起，如B+树索引的存储；非聚簇只存储了数据的指针，需要根据指针进行回表查询</p>
<h3 id="MyISAM非聚簇，InnoDB聚簇"><a href="#MyISAM非聚簇，InnoDB聚簇" class="headerlink" title="MyISAM非聚簇，InnoDB聚簇"></a>MyISAM非聚簇，InnoDB聚簇</h3><h3 id="联合索引最左前缀"><a href="#联合索引最左前缀" class="headerlink" title="联合索引最左前缀"></a>联合索引最左前缀</h3><p>联合索引在 B+ 树中是复合的数据结构，按照从左到右的顺序依次建立搜索树的 (name 在左边，age 在右边)。注意，name 是有序的，age 是无序的。当 name 相等的时候，age 才有序。当我们使用 <code>where name= &#39;张三&#39; and age = &#39;20&#39;</code> 去查询的时候， B+ 树会优先比较 name 来确定下一步应该搜索的方向，往左还是往右。</p>
<h2 id="数据库三大范式"><a href="#数据库三大范式" class="headerlink" title="数据库三大范式"></a>数据库三大范式</h2><ul>
<li><p>第一范式 (1NF)：属性不可分割，即<code>每个属性都是不可分割的原子项</code>。(实体的属性即表中的列)，如地址可以分为：省-市-县</p>
</li>
<li><p>第二范式(2NF)：满足第一范式；且不存在部分依赖，即<code>非主属性必须完全依赖于主属性</code>。(主属性即主键；完全依赖是针对于[联合主键]的情况，非主键列不能只依赖于主键的一部分)</p>
<p>如一个表中有学生id、学生成绩、课程id、课程名；课程名依赖于课程id，学生成绩依赖于学生id，必须建立联合索引才能满足完全依赖主键</p>
</li>
<li><p>第三范式(3NF)：满足第二范式；且<code>不存在传递依赖</code>，数据表必须满足第一和第二范式，同时每个非主键列不应该传递依赖于主键。换句话说，如果非主键列依赖于其他非主键列，那么应将这些非主键列拆分为另一个表，以消除传递依赖关系。即所有非主键属性都只和<strong>候选键（主键是其子集）</strong>有相关性，非主键属性之间应该是独立无关的。</p>
</li>
<li><p>巴斯-科德范式（BCNF）。在满足第三范式的基础上，进一步要求所有非主键属性都独立于其他非主键属性，即消除列与列之间的传递依赖。</p>
</li>
<li><p>第四范式（4NF）<br>在巴德范式的基础上，把同一表内多对多的关系删除</p>
<p>举例：<br>职工表（职工编号，职工姓名，职工选修课）<br>该表中，同一个职工可能有多个孩子，也可能选修多个课程，这就是多对多的关系，不符合4NF</p>
</li>
<li><p>第五范式（5NF）了解即可<br>第五范式又叫完美范式，在4NF的基础上，消除非候选键的连接依赖</p>
</li>
</ul>
<h2 id="char和varchar"><a href="#char和varchar" class="headerlink" title="char和varchar"></a>char和varchar</h2><ul>
<li>char固定长度，不够长填充空格，存取速度快，但是会占多余空间，最长存255个</li>
<li>varchar变长，可存65532个，速度慢，空间小</li>
</ul>
<h2 id="小表驱动大表"><a href="#小表驱动大表" class="headerlink" title="小表驱动大表"></a>小表驱动大表</h2><ul>
<li>减少内存消耗：将小表放在驱动大表的位置可以减少内存消耗。当进行关联查询时，MySQL会将[驱动表]的数据加载到内存中，然后逐行与被驱动表进行匹配。如果驱动表很大，那么需要占用较多的内存来存储它的数据。</li>
<li>减少磁盘IO操作：将小表放在驱动大表的位置可以减少磁盘IO操作。MySQL在执行关联查询时，需要从磁盘读取相关表的数据。如果驱动表很大，那么需要进行大量的磁盘IO操作来读取它的数据。</li>
<li>利用索引提高查询效率：将小表放在驱动大表的位置可以更好地利用索引来提高查询效率</li>
<li>并不一定left join时左边的就是驱动表，如果后面有where语句则不一定，<code>a left join b on a.id=b.id whewe b.id&gt;5</code>如果where后面有b的相关条件，则b为驱动表</li>
</ul>
<h2 id="in与exist"><a href="#in与exist" class="headerlink" title="in与exist"></a>in与exist</h2><ul>
<li><p>如果查询的两个表大小相当，那么用 in 和 exists 差别不大。</p>
</li>
<li><p>如果两个表中一个较小，一个是大表，则子查询表大的用 exists，子查询表小的用 in。</p>
</li>
<li><p>in 是把外表和内表作 hash 连接，而 exists 是对外表作 loop 循环，每次 loop 循环再对内表进行查询。</p>
</li>
<li><p>如果查询语句使用了not in 那么内外表都进行全表扫描，没有用到索引；而not extsts 的子查询依然能用到表上的索引。所以无论那个表大，用not exists都比not in要快。</p>
</li>
</ul>
<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><ul>
<li><p><strong>类型</strong></p>
<ul>
<li><p><strong>二进制日志</strong>（Binary Log）：记录了所有修改数据库状态的 SQL 语句，以及每个语句的执行时间，如 INSERT、UPDATE、DELETE 等，但不包括 SELECT 和 SHOW 这类的操作。</p>
<p>以及两个 InnoDB 存储引擎特有的日志文件：</p>
</li>
<li><p><strong>重做日志</strong>（Redo Log）：记录了对于 InnoDB 表的每个写操作，不是 SQL 级别的，而是物理级别的，主要用于崩溃恢复。</p>
</li>
<li><p><strong>回滚日志</strong>（Undo Log，或者叫事务日志）：记录数据被修改前的值，用于事务的回滚。</p>
</li>
</ul>
</li>
<li><p><strong>bin log和redo log区别</strong>：</p>
<ul>
<li><p>bin log 会记录所有与数据库有关的修改日志记录，包括 InnoDB、MyISAM 等存储引擎的日志，而 redo log 只记 <strong>InnoDB 存储</strong>引擎的日志。</p>
</li>
<li><p>记录的内容不同，bin log 记录的是关于一个事务的具体操作内容，即该日志是逻辑日志。而 redo log 记录的是关于每个页（Page）的更改的物理情况。</p>
</li>
<li><p>写入的时间不同，bin log 仅在事务提交前进行提交，也就是只写磁盘一次。而在事务进行的过程中，却不断有 redo ertry 被写入 redo log 中。</p>
</li>
<li><p>写入的方式也不相同，redo log 是循环写入和擦除，bin log 是追加写入，不会覆盖已经写的文件。</p>
</li>
</ul>
</li>
</ul>
<h2 id="B-树索引数量"><a href="#B-树索引数量" class="headerlink" title="B+树索引数量"></a>B+树索引数量</h2><p>一页的大小为16kB非叶子节点一页可以存1170个键值对，每个键值对可以指向一页数据，一页数据有16条</p>
<p><img src="/2023/11/30/MySQL/image-20240423221520254.png" alt="image-20240423221520254"></p>
<h2 id="Hash-索引和-B-树索引区别是什么？"><a href="#Hash-索引和-B-树索引区别是什么？" class="headerlink" title="Hash 索引和 B+ 树索引区别是什么？"></a>Hash 索引和 B+ 树索引区别是什么？</h2><ul>
<li>B+ 树索引可以进行范围查询，Hash 索引不能。</li>
<li>B+ 树索引支持联合索引的最左侧原则，Hash 索引不支持。</li>
<li>B+ 树索引支持 order by 排序，Hash 索引不支持。</li>
<li>Hash 索引在等值查询上比 B+ 树索引效率更高。</li>
<li>B+ 树使用 like 进行模糊查询的时候，<code>LIKE &#39;abc%&#39;</code> 的话可以起到索引优化的作用，Hash 索引无法进行模糊查询。</li>
<li>B树相对于二叉树、红黑树能够减少IO和查询次数，因为每次磁盘IO都以页为单位</li>
</ul>
<h2 id="联合索引"><a href="#联合索引" class="headerlink" title="联合索引"></a>联合索引</h2><ul>
<li>(A,B,C) 联合索引 <code>select * from tbn where a=? and b in (?,?) and c&gt;?</code>会走联合索引吗<br>会，满足最左前缀法则</li>
<li>(A,B,C) 联合索引  a&#x3D;1,c&#x3D;1会走联合索引吗<br>会，但是缺少了b无法精确定位到行，可以使用索引缩小范围</li>
</ul>
<h2 id="索引下推"><a href="#索引下推" class="headerlink" title="索引下推"></a>索引下推</h2><ul>
<li><p>不使用索引条件下推优化时存储引擎通过索引检索到数据，然后返回给 MySQL Server，MySQL Server 进行过滤条件的判断。</p>
</li>
<li><p>当使用索引条件下推优化时，如果存在某些被索引的列的判断条件时，MySQL Server 将这一部分判断条件<strong>下推</strong>给存储引擎，然后由存储引擎通过判断索引是否符合 MySQL Server 传递的条件，只有当索引符合条件时才会将数据检索出来返回给 MySQL 服务器，<strong>减少了回表次数</strong></p>
</li>
<li><p>将server层的判断条件下推到引擎层</p>
</li>
<li><p>MySQL 服务层：也就是 SERVER 层，用来解析 SQL 的语法、语义、生成查询计划、接管从 MySQL 存储引擎层上推的数据进行二次过滤等等。（下推指的就是二次过滤下推到引擎）</p>
<p>MySQL 存储引擎层：按照 MySQL 服务层下发的请求，通过索引或者全表扫描等方式把数据上传到 MySQL 服务层</p>
</li>
<li><img src="/2023/11/30/MySQL/image-20240424103421398.png" alt="image-20240424103421398" style="zoom:50%;">
</li>
<li><p>例：name，age为联合索引，使用搜索条件<code>where name like &#39;张%&#39; and age=10</code>name使用了范围查询，age无法使用索引，所以需要回表多次，根据name字段查询其age是否为10</p>
</li>
<li><p>若使用了索引下推，可直接进行过滤，只需要回表一次</p>
</li>
</ul>
<h2 id="MySQL事务"><a href="#MySQL事务" class="headerlink" title="MySQL事务"></a>MySQL事务</h2><ul>
<li>特性<ul>
<li><strong>原子性</strong>：事务的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务中的操作不能只执行其中一部分。</li>
<li><strong>一致性</strong>：事务应确保数据库的状态从一个一致状态转变为另一个一致状态。一致性与业务规则有关，比如银行转账，不论事务成功还是失败，转账双方的总金额应该是不变的。</li>
<li><strong>隔离性</strong>：多个并发事务之间需要相互隔离，即一个事务的执行不能被其他事务干扰。</li>
<li><strong>持久性</strong>：一旦事务提交，则其所做的修改将永久保存到数据库中。即使发生系统崩溃，修改的数据也不会丢失。</li>
</ul>
</li>
<li>undo log保证原子性，在事务进行数据修改时会记录数据初始值</li>
<li>一致性是目的，保证了AID就保证了C</li>
<li>redo log保证持久性，事务操作时会首先写入redo log，被称为write-ahead logging</li>
<li>隔离性由MVCC保证</li>
</ul>
<h2 id="主从赋值原理"><a href="#主从赋值原理" class="headerlink" title="主从赋值原理"></a>主从赋值原理</h2><ul>
<li>master 数据写入，更新 binlog</li>
<li>master 创建一个 dump 线程向 slave 推送 binlog至从节点</li>
<li>slave 连接到 master 的时候，会创建一个 IO 线程接收 binlog，并记录到 relay log 中继日志中</li>
<li>slave 再开启一个 sql 线程读取 relay log 事件并在 slave 执行，完成同步</li>
<li>slave 记录自己的 binglog</li>
</ul>
<h2 id="主从同步延迟"><a href="#主从同步延迟" class="headerlink" title="主从同步延迟"></a>主从同步延迟</h2><ul>
<li>写操作之后的读操作发送给主库，留一段时间延迟用于同步</li>
<li>读从库失败后再读一次主库</li>
<li>关键业务指向主库，非关键业务再采用读写分离</li>
</ul>
<h2 id="删除表和添加字段"><a href="#删除表和添加字段" class="headerlink" title="删除表和添加字段"></a>删除表和添加字段</h2><ul>
<li>删表先删索引，否则删除数据时会改变索引更耗时</li>
<li>添加字段可以用中间表，避免长时间锁表</li>
</ul>
<h2 id="DDL和DML"><a href="#DDL和DML" class="headerlink" title="DDL和DML"></a>DDL和DML</h2><p>DML(Data Manipulation Language)数据操纵语言：<br>适用范围：对数据库中的数据进行一些简单操作，如insert,delete,update,select等.<br>DDL(Data Definition Language)数据定义语言：<br>适用范围：对数据库中的某些对象(例如，database,table)进行查看、创建修改删除等管理，如Create,Alter和Drop.</p>
<p>区别：<br>    1.DML操作是可以手动控制事务的开启、提交和回滚的。<br>    2.DDL操作是隐性提交的，不能rollback</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Rain Hu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/11/30/MySQL/">http://example.com/2023/11/30/MySQL/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank"></a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="/image/spongebob.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/12/19/Git%E5%9F%BA%E7%A1%80/" title="Git基础"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Git基础</div></div></a></div><div class="next-post pull-right"><a href="/2023/05/29/Weakly-Supervised-ICH-Segmentation/" title="Weakly Supervised ICH Segmentation"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Weakly Supervised ICH Segmentation</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/image/spongebob.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Rain Hu</div><div class="author-info__description">HUST</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/rainhu22"><i class="fab fa-github"></i><span>关注我</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mysql"><span class="toc-number">1.</span> <span class="toc-text">Mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql%E9%94%81%E6%9C%BA%E5%88%B6"><span class="toc-number">1.1.</span> <span class="toc-text">Mysql锁机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.</span> <span class="toc-text">索引失效场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.</span> <span class="toc-text">覆盖索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E6%85%A2%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.</span> <span class="toc-text">如何处理慢查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql%E6%9F%A5%E8%AF%A2%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E7%94%A8Gap%E9%94%81"><span class="toc-number">1.5.</span> <span class="toc-text">Mysql查询什么时候用Gap锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#InnoDB%E5%92%8CMyISAM%E5%8C%BA%E5%88%AB"><span class="toc-number">1.6.</span> <span class="toc-text">InnoDB和MyISAM区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B%E6%A0%91%E5%92%8CB-%E6%A0%91%E5%AF%B9%E6%AF%94"><span class="toc-number">1.7.</span> <span class="toc-text">B树和B+树对比:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9B%B8%E5%85%B3"><span class="toc-number">1.8.</span> <span class="toc-text">索引相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E7%B0%87%E4%B8%8E%E9%9D%9E%E8%81%9A%E7%B0%87"><span class="toc-number">1.8.1.</span> <span class="toc-text">聚簇与非聚簇</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyISAM%E9%9D%9E%E8%81%9A%E7%B0%87%EF%BC%8CInnoDB%E8%81%9A%E7%B0%87"><span class="toc-number">1.8.2.</span> <span class="toc-text">MyISAM非聚簇，InnoDB聚簇</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80"><span class="toc-number">1.8.3.</span> <span class="toc-text">联合索引最左前缀</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F"><span class="toc-number">1.9.</span> <span class="toc-text">数据库三大范式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#char%E5%92%8Cvarchar"><span class="toc-number">1.10.</span> <span class="toc-text">char和varchar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E8%A1%A8%E9%A9%B1%E5%8A%A8%E5%A4%A7%E8%A1%A8"><span class="toc-number">1.11.</span> <span class="toc-text">小表驱动大表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#in%E4%B8%8Eexist"><span class="toc-number">1.12.</span> <span class="toc-text">in与exist</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97"><span class="toc-number">1.13.</span> <span class="toc-text">日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B-%E6%A0%91%E7%B4%A2%E5%BC%95%E6%95%B0%E9%87%8F"><span class="toc-number">1.14.</span> <span class="toc-text">B+树索引数量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hash-%E7%B4%A2%E5%BC%95%E5%92%8C-B-%E6%A0%91%E7%B4%A2%E5%BC%95%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.15.</span> <span class="toc-text">Hash 索引和 B+ 树索引区别是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-number">1.16.</span> <span class="toc-text">联合索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8"><span class="toc-number">1.17.</span> <span class="toc-text">索引下推</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E4%BA%8B%E5%8A%A1"><span class="toc-number">1.18.</span> <span class="toc-text">MySQL事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E8%B5%8B%E5%80%BC%E5%8E%9F%E7%90%86"><span class="toc-number">1.19.</span> <span class="toc-text">主从赋值原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%BB%B6%E8%BF%9F"><span class="toc-number">1.20.</span> <span class="toc-text">主从同步延迟</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8%E5%92%8C%E6%B7%BB%E5%8A%A0%E5%AD%97%E6%AE%B5"><span class="toc-number">1.21.</span> <span class="toc-text">删除表和添加字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DDL%E5%92%8CDML"><span class="toc-number">1.22.</span> <span class="toc-text">DDL和DML</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/21/JVM/" title="JVM">JVM</a><time datetime="2024-03-21T07:35:22.000Z" title="发表于 2024-03-21 15:35:22">2024-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/23/JUC/" title="JUC">JUC</a><time datetime="2024-02-23T11:48:08.000Z" title="发表于 2024-02-23 19:48:08">2024-02-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/23/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="Java基础知识">Java基础知识</a><time datetime="2024-01-23T08:47:00.000Z" title="发表于 2024-01-23 16:47:00">2024-01-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/01/12/Redis/" title="Redis">Redis</a><time datetime="2024-01-12T01:31:50.000Z" title="发表于 2024-01-12 09:31:50">2024-01-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/12/19/Git%E5%9F%BA%E7%A1%80/" title="Git基础">Git基础</a><time datetime="2023-12-19T02:26:53.000Z" title="发表于 2023-12-19 10:26:53">2023-12-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Rain Hu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>